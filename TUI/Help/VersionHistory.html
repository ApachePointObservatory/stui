<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<title>STUI:Version History</title>
</head>
<body>

<h2><a href="index.html">STUI</a>:Version History</h2>

<h3>Compatibility</h3>

<ul>
	<li>Mac: works with MacOS X 10.6 - 10.8; a version for older Macs can be made on request.
	<li>Unix: runs from source, so is compatible with all flavors of unix. See the <a href="Installation.html">installation instructions</a> for the required version of Python and other libraries.
	<li>No Windows releases are planned.
</ul>

<h3>Version 1.3b8+ 2013-08-16</h3>

<p>Visible changes:
<ul>
    <li>The computer platform is now listed in the error log (or stdout on unix).
    <li>Added a script: Engineering:Test BOSS Collimator which exercises the collimator motors.
</ul>

<p>Bug fixes:
<ul>
    <li>The Mac version can now be run in 32-bit mode. (Formerly the included PIL was incompatible, which resulted in failure to show guide images.)
</ul>

<h3>Version 1.3b8 2013-07-16</h3>

<p>Visible changes:
<ul>
    <li>Includes an udpated Apogee timer script
</ul>

<p>Bug fixes:
<ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1807">1807</a>: opscore.actor.ScriptRunner mishandles a failed wait.
    <li>Mac build only: the included matplotlib would not work on MacOS X 10.6 and (probably) 10.7 due to <a href="https://github.com/matplotlib/matplotlib/issues/2151">matplotlib issue 2151</a>.
</ul>

<h3>Version 1.3b7 2013-05-17</h3>

<p>Bug fixes:
<ul>
    <li>GuideWdg: variables "havePlateInfo" and "plateInfo" were not always defined before being used.
</ul>

<h3>Version 1.3b6 2013-05-15</h3>

<p>Internal changes:
<ul>
    <li>AssembleImage moved from stui to opscore/utilities at John Parejko's request.
</ul>

<h3>Version 1.3b5 2013-05-13</h3>

<p>Visible changes:
<ul>
    <li>Added guide probe annotation to non-plate-view guide images.
    <li>Improvements by Elena to various scripts:
    <ul>
        <li>Observations/Log Function now shows mcp.gang, and boss.motorPosition should be more reliable.
        <li>APOGEE/Timer: renamed to APOGEE/apogeeTimer, added format and colors, and time left is None if no exposures remain in the sop sequence.
    </ul>
</ul>

<p>Bug fixes:
<ul>
    <li>Older guide images without gprobebits information could not be displayed in plate view.
</ul>

<h3>Version 1.3b4 2013-03-29</h3>

<p>Visible changes:
<ul>
    <li>Added +/- suffix to guide probe labels in guider windows.
</ul>

<p>Internal changes:
<ul>
    <li>Updated to latest trunk version of actorkeys.
</ul>

<h3>Version 1.3b3 2013-03-28</h3>

<p>Bug fixes:
<ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1765">1765</a>: error when attempting to enable or disable a fiber.
</ul>

<h3>Version 1.3b2 2013-03-27</h3>

<p>Visible changes:
<ul>
    <li>Guider window: put exposure time and related controls all on the same line, to save space.
</ul>

<p>Bug fixes:
<ul>
    <li>Guider window: removed space between the above/below focus indicator and the probe name and worked around a TkAqua bug that could cause the name of the last probe in a row to be hidden.
</ul>

<h3>Version 1.3b1 2013-03-25</h3>

<p>Visible changes:
<ul>
    <li>Guider window:
    <ul>
        <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1757">1757</a>: add a Stack option.
        <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1704">1704</a>: each guide probe's number is followed by + or - if the probe is an above-focus or below-focus probe.
    </ul>
    <li>SOP window: implemented ticket <a href="https://trac.sdss3.org/ticket/1735">1735</a>: swap Stop and Modify buttons.
    <li>Scripts menu: Run_Commands now supports "tui wait <i>nSec</i>", thanks to Elena Malanushenko.
</ul>

<p>Internal changes:
<ul> 
    <li>Eliminated the synthesized keyword guider.fullGProbeBits and modified STUI code to use gprobeBits directly, now that ticket <a href="https://trac.sdss3.org/ticket/433">433</a> is fixed.
</ul>

<h3>Version 1.2 2012-12-19</h3>

<p>Requirements changes:
<ul>
    <li>The Mac version now requires MacOS X 10.6 or later
    <li>Users running from source must use RO package 3.1.0 or later
</ul>

<p>Visible changes:
<ul>
    <li>Updated the interlocks displays based on plc v29_1.
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1688">1688</a> SOP safeguards:
    <ul>
        <li>The "X" buttons now only re-enable your local SOP buttons (so you can send another SOP command); it never sends anything to SOP. Thus it is always safe to press "X".
        <li>The "Stop" buttons always bring up a dialog box asking for confirmation.
    </ul>
    <li>The guider window now shows 0=BOSS, 1=APOGEE for refraction balance and it no longer tries to use guider keyword refractionWavelengths, since that keyword is obsolete.
    <li>All checkbuttons are now displayed with a checkbox, because this is required on MacOS X when using Tcl/Tk 8.5.
    <li>Removed the useless and outdated Permissions window.
    <li>Removed state of MARVELS gang connector from MCP window.
</ul>

<p>Bug fixes:
<ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1714">1714</a> STUI shows wrong time if computer not on UTC. TUI now shows the correct time even if the user's clock is keeping TAI or has drifted. However, displayed time may be off by a second or two unless the computer's clock is keeping accurate UTC or TAI.
</ul>

<p>Internal changes:
<ul>
    <li>Mac version uses Aqua Tcl/Tk 8.5, which has many internal changes compared to 8.4.
    <li>Modified to use apo/plc instead of apo/interlocks.
    <li>Updated to use current actorkeys.
    <li>Now has the ability to use Twisted framework for communications, though this is off by default since it is slower. Change a flag in Main.py to use Twisted.
    <li>Removed use of update_idletasks to eliminate a source of subtle bugs.
    <li>Most timers now use RO.TkUtil.Timer; this simplifies the code a bit and eliminates the need for some Tk widgets.
    <li>Removed use of deprecated dict method has_key.
</ul>

<h3>Version 1.1.2b5 2012-06-19</h3>

<p>Visible changes:
<ul>
    <li>Added Elena's Observations/Log Support script. 
</ul>

<p>Bug fixes:
<ul>
    <li>Improved compatibility with Tcl/Tk 8.5 on Mac OS X by eliminating a cause of duplicate application menus.
    <li>The Mac application should play sounds more reliably. (I removed an unused smpeg library that appeared to be causing problems).
</ul>

<h3>Version 1.1.2b4 2012-06-04</h3>

<p>Visible changes:
<ul>
    <li>Increased the time range from 700 seconds to 1800 seconds to match most of the others; if this is a problem, please let Russell know.
</ul>

<p>Bug fixes:
<ul>
    <li>Plays guider sound cues. This corrects a long standing oversight: sound cues were present, but never played. I also improved the sound cues.
    <li>Added missing sound cue for Elena's fiducials script (I had copied the script, but not the sound cue) and made the sound a bit louder.
    <li>Fixed clear buttons on strip chart widgets.
</ul>

<p>Internal changes:
<ul>
    <li>Reduce CPU usage by making hidden strip charts do much less work. If STUI is bogging down your machine close the strip charts that you don't need.
</ul>

<h3>Version 1.1.2b3 2012-06-01</h3>

<p>Visible changes:
<ul>
    <li>The Mac application now requires 10.6 or later. If this is a big problem I can make a version for older Macs.
    <li>Incorporated many of Elena Malanushenko's scripts. Most of these are in the Script menu with new names, but the plotting strip chart scripts are now normal windows in the Inst menu (using the name Monitor, for consistency). The Test Actors script is now faster and more robust (it sends all commands at once, then reports replies as they come back).
    <li>Added a clear button, labelled "C", to most or all strip charts.
</ul>

<h3>Version 1.1.2b2 2012-03-28</h3>

<p>Visible changes:
<ul>
    <li>Guider window
    <ul>
        <li>User Corr RA and Dec limits increased from +/-10 to +/-30"
        <li>User Corr Apply shows the state of each command sent in the status bar
    </ul>
</ul>

<p>Bug fixes:
<ul>
    <li>Guider window: User Corr Scale did not work (it was sending its command to the TCC instead of the guider).
</ul>


<h3>Version 1.1.2b1 2011-11-08</h3>

<p>Visible changes:
<ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1476">1476</a> make guider failures more visible.
    <ul>
        <li>Guider and exposure state are shown in uppercase if the condition is an error.
        <li>The color of the word Guider and Exposure match the severity of the associated state.
    </ul>
</ul>

<p>Bug fixes:
<ul>
    <li>Guider exposure state is now shown in the color appropriate to the severity of the state; formerly the severity was computed but ignored.
</ul>

<h3>Version 1.1.1 2011-09-23</h3>

<p>Visible changes:
<ul>
    <li>APOGEE QL exposure table title includes the exposure type.
</ul>

<p>Bug fixes:
<ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1442">1442</a> exception in _utrDataCallback.
</ul>

<h3>Version 1.1 2011-09-09</h3>

<p>Visible changes:
<ul>
    <li>APOGEE: added support for APOGEE and APOGEE QuickLook

    <li>SOP window:
    <ul>
        <li>Added commands for APOGEE.
        <li>Bypassed systems are now shown in red (at Craig's suggestion) and you can now cancel bypass commands to re-enable the buttons.
        <li>Added alt field for Goto Gang Change.
        <li>SOP commands for BOSS are now shown with "(BOSS)". The parenthesis indicate that you leave out the "BOSS" when typing the commands on the command line.
        <li>Buttons that showed "Go To..." now show "Goto..." to simplify the mapping between the SOP window and sop commands: type what you see except lowercase the first letter and omit spaces and text in parenthesis.
        <li>Help strings for parameters now show the name you send to sop, not the displayed name, to simplify the mapping between the SOP window and sop commands. (This was already true of command buttons).
    </ul>

    <li>Guider Window:
    <ul>
        <li>Added support for refraction balance ratio guide parameter.
        <li>Ticket <a href="https://trac.sdss3.org/ticket/620">620</a>: add guider CCD temperature to Guider window.
        <li>You may apply guide parameter changes even if the guider is off.
        <li>Guider and exposure state are now displayed in color to indicate severity. The only "normal" guide state is "on" because we always run the guider while taking science data.
        <li>The exposure time widget always tracks the current value from the guider, it no longer tracks data from the currently displayed image. I hope this will be less confusing for users.
        <li>Updated to handle new "failed" guider and exposure states (thanks, Craig!).
    </ul>
    
    <li>Some windows now save state when you select Save Window Positions.
    <ul>
        <li>Log windows save filter information.
        <li>APOGEE saves which detail panels are open.
    </ul>

    <li>Log window:
    <ul>
        <li>Added filters "Commands", "Commands and Replies", "My Commands and Replies".
        <li>Show a CmdStarted and CmdDone message for each command (using data from the cmds actor).
    </ul>

    <li>MCP window: added status of APOGEE and MARVELS gang connector sensors.
</ul>

<p>Bug fixes:
<ul>
    <li>SOP did not shrink when stages were removed from commands.
    <li>TUI.Base.Wdg.FocusWdg had some minor bugs that were exposed by the new APOGEE Collimate controls.
</ul>

<p>Internal changes:
<ul>
    <li>LogEntry objects now have a cmdID field for enhanced filtering.
    <li>Added code to the Alerts window to work around hub bug <a href="https://trac.sdss3.org/ticket/1181">1611</a>1611 (keys that have a list of 0 values are reported by the keys actor to have a single value of "None"). This avoids error messages when there are no active alerts or disabled alert rules.
</ul>

<h3>Version 1.0+1 2011-04-04</h3>

<p>Visible changes:
<ul>
    <li>Added a preliminary APOGEE window. It only shows some QuickLook data and has no controls.
</ul>

<p>Internal changes:
<ul>
    <li>Stop sending "plot display=..." as part of the guide on command. It is not longer needed and it caused an error message if the DISPLAY environment variable was not set.
</ul>

<h3>Version 1.0 2011-03-15</h3>

<p>Release 1.0b17 as 1.0 with no changes.

<h3>Version 1.0b17 2011-02-16</h3>

<p>Visible changes:
<ul>
    <li>The Status window now shows the calibration and guide offsets.
</ul>

<p>Bug fixes:
<ul>
    <li>Log window filtering showed all messages instead of None if the severity was set to None or the additional criteria were missing or incomplete.
</ul>

<h3>Version 1.0b16 2011-02-03</h3>

<p>Visible changes:
<ul>
    <li>Added an experimental Custom filter to the Log window to permit more complicated filter expressions. See the <a href="TUIMenu/LogWin.html">Log Window</a> documentation for details. There is no support as yet for saving or sharing expressions.
</ul>

<h3>Version 1.0b15 2011-02-01</h3>

<p>Visible changes:
<ul>
    <li>Added a Center Up button to the Guider window.
    <li>Alerts window:
    <ul>
        <li>Changed the sort order to (severity, age, alert ID); formerly age was not considered.
        <li>Changed the two lists to always scroll to the top after the data changes, so the most important information is always visible.
    </ul>
    <li>The logs retain more information. Coupled with a separate improvement to BOSS (metrology is now reported using debug-level messages thanks to Craig Loomis) STUI logs should now show several hours of data.
</ul>

<h3>Version 1.0b14 2011-01-12</h3>

<p>Visible changes:
<ul>
    <li>Cartridge 18 now shows up as cartridge 18 in the Status window. The engineering camera will show up as a mystery number because I have no idea what value the MCP reports.
    <li>The Guider now includes headings for the table in the correction panel, since the rollover help was insufficient.
    <li>The Guider now allows user-specified rotation correction up to +/- 100" (RA and Dec remain at +/-10").
    <li>The Guide Monitor now plots FWHM of in-focus guide probes.
</ul>

<p>Internal changes:
<ul>
    <li>The Mac version includes matplotlib 1.0.1 which reduces the memory leak by 10x. I advise anyone running from source to upgrade your matplotlib.
</ul>

<p>Bug fixes:
<ul>
    <li>The Guider could not display a plate image if there were no small postage stamps. Thanks to Craig Loomis for the bug report and fix.
    <li>The Guider's displayed scale measured error and applied correction were 100x too small.
</ul>

<h3>Version 1.0b13 2010-12-23</h3>

<p>Visible changes:
<ul>
    <li>Added clipped mean FWHM to Seeing chart in Guide Monitor.
</ul>

<p>Internal changes:
<ul>
    <li>Requires RO package 2.7.
    <li>Modified for backward-incompatible StripChartWdg.
</ul>

<h3>Version 1.0b12 2010-12-10</h3>

<p>Visible changes:
<ul>
    <li>Reduced rate of memory leakage by 10x by shifting the guide monitor's time axis every 10 seconds instead of every second. The display will be jerkier but you will still see all data. I'll restore the old behavior once the matplotlib memory leak is fixed.
</ul>

<h3>Version 1.0b11 2010-12-08</h3>

<p>Bug fixes:
<ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1181">1181</a> STUI 1.0b10 cannot display the plate view for 55534/proc-gimg-1363.fits.
    <li>Fixed a minor memory leak in RO.Wdg.StripChartWdg; unfortunately a much larger memory leak remains due to a fundamental <a href="https://sourceforge.net/tracker/?func=detail&amp;atid=560720&amp;aid=3124990&amp;group_id=80706">bug in matplotlib</a>.
</ul>

<h3>Version 1.0b10 2010-11-22</h3>

<p>Visible changes:
<ul>
    <li>Changed the Guide window displayed error and correction to labels (which cannot be copied) from read-only entry widgets. This avoids beeps for NaNs and may be less confusing.
</ul>

<h3>Version 1.0b9 2010-11-22</h3>

<p>Bug fix: the correction enable buttons in the Guider did not show the current state.

<h3>Version 1.0b8 2010-11-22</h3>

<p>Visible changes:
<ul>
    <li>Guider window:
    <ul>
        <li>Added net guide correction
        <li>Added an indication of whether the most recent correction was applied
    </ul>
    <li>Scale is now shown as ((plate/nominal - 1) * 1e6) everywhere (Guider, Guide Monitor and Status). Reasonable corrections are thus in the 1s and 10s.
</ul>

<p>Bug fixes:
<ul>
    <li>Eliminated an innocuous but annoying traceback that appeared in the error log after each guide exposure.
</ul>

<h3>Version 1.0b7 2010-11-19</h3>

<p>Visible changes:
<ul>
    <li>Experimental support for entering guide corrections manually. Note: Paul Harding and I would greatly prefer to present scale change in units of fraction * 10^6 instead of fraction * 100. If we do this the old guider keywords and setScale command will still work in the old units but will be deprecated.
</ul>

<p>Bug fixes:
<ul>
    <li>MJD was off (I had the sign of the offset wrong).
    <li>Cartridge display was blank if the MCP and guider agreed.
    <li>My attempt to suppress "Warning: invalid value encountered in divide" by suppressing division warnings was insufficient. I now suppress all numpy warnings.
</ul>

<h3>Version 1.0b6 2010-11-18</h3>

<p>Visible changes:
<ul>
    <li>Added Stop button to SOP stages that can be aborted.
    <li>Improved the Guide Monitor (based on work by Craig Loomis).
    <li>Added target axis position, TAI date and SDSS MJD to the Status window.
    <li>Consolidated Inst ID and Cartridge in Status window; Cartridge now shows both the MCP and guider values if they disagree.
    <li>Added Calibration offsets to the Nudger window.
    <li>Renamed Object offset to Object Arc offset in the Nudger, Offset and Status windows and reorganized the associated help files to better consolidate information about types of offsets.
    <li>Ticket <a href="https://trac.sdss3.org/ticket/618">618</a> need counterweight info in STUI MCP display.
</ul>

<h3>Version 1.0b5 2010-10-18</h3>

<p>Bug fixes:
<ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1097">1097</a> Enable/Disable buttons on Guider GUI send the wrong command.
    <li>Fixed a typo in the name of the Fiducials window (reported by Dan Oravitz).
</ul>

<h3>Version 1.0b4 2010-10-01</h3>

<p>Visible changes:
<ul>
    <li>Added a Guide Monitor
</ul>

<p>Internal changes:
<ul>
    <li>Added TUI.Base.StripChartWdg, a convenient way to plot keyvars.
</ul>

<h3>Version 1.0b3 2010-09-30</h3>

<p>Visible changes:
<ul>
    <li>Added a Fiducials window (based on a script by Elena Malanushenko) to show a log of fiducial crossings.
    <li>Added guide probe enable/disable widgets to the Guider window.
    <li>Guide plate image improvements:
    <ul>
        <li>Made the probe images larger
        <li>Improved placement of guide probe number labels
    </ul>
    <li>Interlocks display updated to match the modified interlocks.
</ul>

<p>Internal changes:
<ul>
    <li>Removed deprecated instrument model files. Always use TUI.Models.getModel(actor) to get a model.
    <li>Added fullGProbeBits to the guider model; this combined gprobeBits and gprobes and is intended as a workaround until the real gprobeBits keyword contains enable/disable info.
    <li>Increased the number of messages held by the central log repository from 2000 lines to 10,000 lines.
</ul>

<h3>Version 1.0b2 2010-07-21</h3>

<p>Visible changes:
<ul>
    <li>If you lose your connection or put your computer to sleep for long enough, TUI will test the connection and, if good, will attempt to refresh the data.
</ul>

<p>Bug fixes:
<ul>
    <li>Log filtering based on command number would not show the outgoing command.
    <li>Would fail to start on unix due to an error in determining the name of the status window.
</ul>

<h3>Version 1.0b1 2010-06-28</h3>

<p>Visible changes:
<ul>
    <li>Multiple log windows.
</ul>

<p>Internal changes:
<ul>
    <li>Added logSource to the TUI model; this is a central repository for log data to support multiple log windows.
</ul>

<p>Bug fixes:
<ul>
    <li>Log window
    <ul>
        <li>New lines are not highlighted when highlighting Actor or Actors.
        <li>Copied text includes filtered-out data.
        <li>Scrolling is irregular if there is a lot of filtered-out data.
    </ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/920">920</a> Fix "Guide" button.
</ul>
</body>
</html>
