<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>STUI:Version History</title>
</head>
<body>

<h2><a href="index.html">STUI</a>:Version History</h2>

<h3>Compatibility</h3>

<ul>
    <li>Mac: the Mac binary works with MacOS 10.6 - 10.10, though on 10.9 and 10.10 you should disable app nap (select Get Info on STUI and check "Disable App Nap"). The Mac version is not signed, so MacOS may complain when you try to launch it for the first time. If that happens simply right-click on the application and select "Open...".
    <li>Unix: runs from source, so is compatible with all flavors of unix. See the <a href="Installation.html">installation instructions</a> for the required version of Python and other libraries.
    <li>No Windows releases are planned.
</ul>

<h3>1.7.0b1 2015-05-28</h3>

<p>Visible changes:
<ul>
    <li>Removed log message warning "halting countdown timer due to AxisCmdState", since it is normal with the new tcc.
</ul>

<p>Bug fixes:
<ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/2375">2375</a>: STUI doesn't show cart 19 in SOP panel.
</ul>

<h3>1.7.0a1 2015-05-08</h3>

<p>Warning: for those running from source: the new Pointing Data script version requires opscore trunk r162246 or later.

<p>Visible changes:
<ul>
    <li>Added script Engineering:Pointing Data which collects pointing data using the engineering camera.
    <li>Updated script Startup:Get Versions for changes to the BOSS ICC.
</ul>

<p>Internal changes:
<ul>
    <li>Added attribute gProbeDict to the guider model
</ul>

<h3>1.6.0 2015-04-03</h3>

<p>This version is designed for use with the new tcc. Users of the source version of STUI (and all other tcc clients) should update their actorkeys to the current trunk version.

<p>Visible changes:

<ul>
    <li>Updated the Mirror Status window for the new tcc and added the missing help document for it.
    <li>Restore the old appearance of the MCP window, because it is properly supported on MacOS by Tcl/Tk 8.5.18.
    <li>Mac version: updated the tcc keyword dictionary to the version for the new tcc.
</ul>

<p>Bug fixes:
<ul>
    <li>Observations:Log Support script: fixed bug with cart number and improved formatting of harmann data.
    <li>Script Observations: Log Function: fixed a bug with survey type output.
</ul>

<p>Internal changes:
<ul>
    <li>Scripts no longer write to the error log file.
    <li>The Mac version includes the actorkeys trunk r161177
    <li>The Mac version includes Tcl/Tk 8.5.18 which fixes many bugs (though I have seen a few reports of windows that fail to close).
    <li>The Mac version includes RO 3.6.5, which removes several workarounds for bugs on MacOS that are no longer needed in Tcl/Tk 8.5.18, and adds one new workaround to avoid cramped buttons.
    <li>Added a software license (BSD-3 in doc/license.txt) and changed readMe.txt to ReadMe.md.
</ul>

<h3>1.5.3 2015-01-27</h3>

<p>This version is designed for use with a recent SOP update.

<p>Visible changes:
<ul>
    <li>Implemented SOP ticket <a href="https://trac.sdss3.org/ticket/2084">2084</a> APOGEE&amp;MaNGA co-observing handling of APOGEE dither mechanism.
    <li>Implemented SOP ticket <a href="https://trac.sdss3.org/ticket/2168">2168</a> Change default APOGEE exposure time for co-observations.
    <li>Log Function script updated.
</ul>

<h3>1.5.2 2014-11-21</h3>

<p>Bug fixes:
<ul>
    <li>The Mac version includes an updated hartmann keyword dictionary.
</ul>

<h3>1.5.1 2014-11-18</h3>

<p>Visible changes:
<ul>
    <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/2173">2173</a> in the script "Observations: Telescope Controls" replaced tcc commands with sop commands and added command "guider loadCartridge" instead of previous outdated goto6 button.
</ul>

<p>Bug fixes:
<ul>
    <li>MacOS:
    <ul>
        <li>A duplicate Preferences menu item was shown and only one worked, and that one did not support cmd-comma.
        <li>A duplicate STUI Help menu item was shown and only one worked.
    </ul>
    <li>The test data for SOP needed a bit of updating.
</ul>

<h3>1.5.0 2014-10-27</h3>

<p>Warnings:
<ul>
    <li>If running from source you must update opscore, actorkeys and RO.
    <li>Older versions of STUI will show an error message when sop outputs a certain keyword; you may ignore that error.
</ul> 

<p>Visible changes:
<ul>
    <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1937">1937</a>: show MaNGA dither information in the guider window.
    <li>Status window: relabelled MJD to SJD to reduce ambiguity.
    <li>Script improvements from Elena:
    <ul>
        <li>Replaced sos actor with hartmann actor in "Test Actors", "Get Versions", and "Log Function" scripts.
        <li>Added "Engineering: Loop Commands" script.
        <li>Added manga dither to Log Function.
    </ul>
    <li>SOP window:
    <ul>
        <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/2061">2061</a>: SOP should show current mode, as reported by the guider survey keyword.
        <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/2101">2101</a>: SOP should show new sop survey keyword, if different than the guider survey keyword (e.g. due to a bypass).
        <li>Added support for new doApogeeMangaDither and doApogeeMangaSequence commands.
        <li>Added an extra status bar to display text from sop.
        <li>"Aborted" is shown in blue, instead of red.
        <li>Enhanced plate type display in SOP to show a pink ? if unknown. (Also fixed a minor bug that caused a traceback in the error log file if the value was None).
        <li>Shrunk field widths, where practical, and shaved a line here and there.
    </ul>
    <li>Script 'Goto 6 MCP' changed to 'Goto 5 MCP'
    <li>Updated the installation instructions.
</ul>

<p>Bug fixes:
<ul>
    <li>Slew window: corrected displayed of units of distance from parsec to au.
    <li>Status was not shown in pink after disconnecting.
    <li>SOP window:
    <ul>
        <li>removed a debugger breakpoint.
        <li>Goto Field command: guider flat time is now properly associated with both the calibs and guider stages.
        <li>doBossCalibs parameters were not shown.
        <li>The sop actor had changed in ways that SOP didn't know about, including adding new kind of stage that the SOP window did not support. SOP continued to work, but it resulted in nasty error messages in the log.
        <li>SOP Goto Field had the guide parameters assigned to the wrong stage. The fix is not perfect, because guider flat time is actually used by two different stages, but nobody seems to care and fixing it would require a major overhaul of the the SOP widget code.
        <li>Message window: typing certain characters in the upper window would cause a traceback in the log. Also navigation keys now work correctly in the upper pane.
        <li>SOP: fixed two cosmetic errors in SOP modules exposed by pyflakes (as well as some bugs in StageInfo.py; a file that STUI is not presently using).
    </ul>
    <li>Guider window used httpGet.getErrMsg() instead of .errMsg (thanks to John Parejko for the fix).
    <li>Closing&gt;Goto 6 MCP script was broken.
    <li>APOGEE&gt;Morning Cals script did not reliably halt if a command failed.
</ul>

<p>Internal changes:
<ul>
    <li>The Mac build includes a release candidate of Tcl/Tk 8.5.17; barring unexpected bugs, this should be a significant improvement over the ancient version I had to use previously, especially for users on MacOS 10.9 (I have no idea how Tcl/Tk works on 10.10).
    <li>The Mac version runs in 64 bit mode again (permissible due to the newer version of Tcl/Tk).
    <li>Source releases now include RO.
    <li>STUI is now in git: git@github.com:r-owen/stui.git
    <li>SOP window:
    <ul>
        <li>updated bypass widget to use new sop keyword "bypassedNames".
        <li>allow parameters to be associated with more than one stage.
        <li>simplified command description format and made it fit the new sop better (if a command has only fake stages then it can be expressed that way).
        <li>updated to sop keyword dictionary rev 157205.        
    </ul>
    <li>Updated to current actorkeys and opscore.
    <li>Updated release script for git.
</ul>

<h3>1.4.0 2014-05-20</h3>

<p>Warning: as of the release date, this version will not work with the released version of SOP. It requires the MaNGA branch of SOP (and of actorkeys, if running from source).

<p>Visible changes:
<ul>
    <li>Log files are now saved to a subdirectory.
    <li>Implemented enhancement request <a href="https://trac.sdss3.org/ticket/1698">1698</a>: moving "Do (BOSS) Calibs" in boss SOP GUI. I moved all calibration-like stages after Goto Gang Change and Goto Instrument Change.
    <li>Implemented enhancement request <a href="https://trac.sdss3.org/ticket/2020">2020</a>: increase STUI scrollback buffer size. I increased the total remembered log entries from 40,000 to 100,000 and the log window scrollback from 20,000 to 100,000. If this becomes a memory issue I may have to make it user-settable, but I'm very reluctant to add another preference or try to guess what the setting should be based on available memory.
    <li>Improved compatibility with MacOS 10.9: the application now runs in 32-bit mode, though you should still manually disable app nap.
    <li>Overhauled the introduction document and expanded the instructions for running the MacOS version there an in this version history.
    <li>Added APOGEE dither_clearing_script.  
    <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1902">1902</a>: Reopen script windows at startup.
    <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1974">1974</a>: SOP command changes for MaNGA
    <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1996">1996</a>: new SOP command apogeeDomeFlat
    <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1745">1745</a>: prevent flat field lamp turning on during exposure by adding an "Enable Commands?" button to the MCP window.
    <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1802">1802</a>: STUI should allow more than 5 log windows.
</ul>

<p>Bug fixes:
<ul>
    <li>Script Pause/Resume lost the value returned by the last wait (fixed in opscore ScriptRunner).
    <li>Ticket <a href="https://trac.sdss3.org/ticket/2018">2018</a>: STUI v1.3.1b3 does not show guider images.
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1884">1884</a>: Apogee evening cals failed from podium laptop
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1915">1915</a>: STUI SOP defaults to Seq Count=3 for APOGEE carts.
</ul>

<p>Internal changes:
<ul>
    <li>Updated actorkeys to revision 155764 of branches/mangadb.
    <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1972">1972</a>: SOP uses guiderTime to specify guider exposure time during gotoField
    <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1836">1836</a>: use "from PIL import Image" instead of "import Image", for compatibility with Pillow (a modern replacement for PIL). Warning: you must update your copy of the RO package to at least 3.2.2 for Pillow compatibility.
    <li>Mac version includes matplotlib 1.3.1.
</ul>

<h3>1.3 2013-09-05</h3>

<p>Visible changes:
<ul>
    <li>SOP window: implemented ticket <a href="https://trac.sdss3.org/ticket/1735">1735</a>: swap Stop and Modify buttons.
    <li>Scripts menu: Run_Commands now supports "tui wait <i>nSec</i>", thanks to Elena Malanushenko.
    <li>Scripts:
    <ul>
        <li>Moved the following scripts from the Elena's scripts package into STUI, with updated names (many of these scripts were also updated):
        <ul>
            <li>APOGEE:apogeeTimer -> APOGEE:Timer
            <li>APOGEE:cartchange -> APOGEE:Cart Change
            <li>APOGEE:eveningcals -> APOGEE:Evening Cals
            <li>BOSS:bossTimer -> BOSS:Timer
            <li>Observations:dustCounter -> Observations:Dust Counter
            <li>Observations:goto6mcp -> Observations:Goto 6 MCP
            <li>Observations:spiralPattern -> Observations:Spiral Pattern
            <li>Startup:plugging -> Startup:Plugging
            <li>Startup:threeReadDark -> Startup:Short Dark
        </ul>
        <li>Added script Engineering:Test BOSS Collimator which exercises the collimator motors and reports motion error statistics.
        <li>Moved the Goto 6 MCP script from Observations to Closing.
    </ul>
    <li>Guider window:
    <ul>
        <li>Added guide probe annotation to non-plate-view guide images.
        <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1757">1757</a>: add a Stack option.
        <li>Implemented ticket <a href="https://trac.sdss3.org/ticket/1704">1704</a>: each guide probe's number is followed by + or - if the probe is an above-focus or below-focus probe.
        <li>Put exposure time and related controls all on the same line, to save space.
    </ul>
    <li>Documentation:
    <ul>
        <li>Updated the overview of <a href="http://sdss3.apo.nmsu.edu/opssoft/stui/Scripts/BuiltInScripts/index.html">built in scripts</a> in STUI's <a href="http://sdss3.apo.nmsu.edu/opssoft/stui/index.html">help</a>.
        <li>Updated the installation instructions.
    </ul>
    <li>Mac version: upgraded to the latest actorkeys and plc v30_2.
    <li>The computer platform is now listed in the error log (or stdout on unix).
</ul>

<p>Bug fixes:
<ul>
    <li>Fixed a bug in opscore that caused refresh of keyvars to fail if the refreshCmdDict is modified at the wrong time. This was triggered by the Test Actors script.
    <li>The tutorial script "5 Actor Versions" had a bug due to bit rot: TCC version is returned in the version keyword (when the script was written it was returned in a text keyword).
    <li>The Mac version can now be run in 32-bit mode (formerly the included PIL was incompatible, which resulted in failure to show guide images).
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1558">1558</a>: there are two different build instructions for STUI.app.
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1807">1807</a>: opscore.actor.ScriptRunner mishandles a failed wait.
    <li>Mac build only: the included matplotlib would not work on MacOS X 10.6 and (probably) 10.7 due to <a href="https://github.com/matplotlib/matplotlib/issues/2151">matplotlib issue 2151</a>.
    <li>GuideWdg: variables "havePlateInfo" and "plateInfo" were not always defined before being used.
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1765">1765</a>: error when attempting to enable or disable a fiber.
    <li>Guider window: worked around a TkAqua bug that could cause the name of the last probe in a row to be hidden.
    <li>Use STUI instead of TUI in startup messages in the log window and error log file.
</ul>

<p>Internal changes:
<ul>
    <li>Added apogeeGangLabelHelp to MCP model (since I could not figure out a nice way to access labelHelp
    given an instance of the apogeeGang Key). An alternative is to make a synthetic keyword such as
    apogeeGangText and hide the ugliness in the model, but then there is no way to know the max length in advance.
    <li>Various code was updated to handle the modified apogeeGang keyword.
    <li>AssembleImage moved from stui to opscore/utilities at John Parejko's request.
    <li>Eliminated the synthesized keyword guider.fullGProbeBits and modified STUI code to use gprobeBits directly, now that ticket <a href="https://trac.sdss3.org/ticket/433">433</a> is fixed.
    <li>The Mac build now uses matplotlib 1.3.0
</ul>

<h3>1.2 2012-12-19</h3>

<p>Requirements changes:
<ul>
    <li>The Mac version now requires MacOS X 10.6 or later
    <li>Users running from source must use RO package 3.1.0 or later
</ul>

<p>Visible changes:
<ul>
    <li>The Mac application now requires 10.6 or later.
    <li>Incorporated many of Elena Malanushenko's scripts. Most of these are in the Script menu with new names, but the plotting strip chart scripts are now normal windows in the Inst menu (using the name Monitor, for consistency). The Test Actors script is now faster and more robust (it sends all commands at once, then reports replies as they come back).
    <li>Added a clear button, labelled "C", to most or all strip charts.
    <li>Updated the interlocks displays based on plc v29_1.
    <li>Guider window
    <ul>
        <li>User Corr RA and Dec limits increased from +/-10 to +/-30"
        <li>User Corr Apply shows the state of each command sent in the status bar
        <li>Shows 0=BOSS, 1=APOGEE for refraction balance and it no longer tries to use guider keyword refractionWavelengths, since that keyword is obsolete.
    </ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1476">1476</a> make guider failures more visible.
    <ul>
        <li>Guider and exposure state are shown in uppercase if the condition is an error.
        <li>The color of the word Guider and Exposure match the severity of the associated state.
    </ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1688">1688</a> SOP safeguards:
    <ul>
        <li>The "X" buttons now only re-enable your local SOP buttons (so you can send another SOP command); it never sends anything to SOP. Thus it is always safe to press "X".
        <li>The "Stop" buttons always bring up a dialog box asking for confirmation.
    </ul>
    <li>All checkbuttons are now displayed with a checkbox, because this is required on MacOS X when using Tcl/Tk 8.5.
    <li>Removed the useless and outdated Permissions window.
    <li>Removed state of MARVELS gang connector from MCP window.
    <li>Increased the time range from 700 seconds to 1800 seconds to match most of the others; if this is a problem, please let Russell know.
</ul>

<p>Bug fixes:
<ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1714">1714</a> STUI shows wrong time if computer not on UTC. TUI now shows the correct time even if the user's clock is keeping TAI or has drifted. However, displayed time may be off by a second or two unless the computer's clock is keeping accurate UTC or TAI.
    <li>Improved compatibility with Tcl/Tk 8.5 on Mac OS X by eliminating a cause of duplicate application menus.
    <li>The Mac application should play sounds more reliably. (I removed an unused smpeg library that appeared to be causing problems).
    <li>Plays guider sound cues. This corrects a long standing oversight: sound cues were present, but never played. I also improved the sound cues.
    <li>Added missing sound cue for Elena's fiducials script (I had copied the script, but not the sound cue) and made the sound a bit louder.
    <li>Fixed clear buttons on strip chart widgets.
    <li>Guider window: User Corr Scale did not work (it was sending its command to the TCC instead of the guider).
    <li>Guider exposure state is now shown in the color appropriate to the severity of the state; formerly the severity was computed but ignored.
</ul>

<p>Internal changes:
<ul>
    <li>Mac version uses Aqua Tcl/Tk 8.5, which has many internal changes compared to 8.4.
    <li>Modified to use apo/plc instead of apo/interlocks.
    <li>Updated to use current actorkeys.
    <li>Now has the ability to use Twisted framework for communications, though this is off by default since it is slower. Change a flag in Main.py to use Twisted.
    <li>Removed use of update_idletasks to eliminate a source of subtle bugs.
    <li>Most timers now use RO.TkUtil.Timer; this simplifies the code a bit and eliminates the need for some Tk widgets.
    <li>Removed use of deprecated dict method has_key.
    <li>Reduce CPU usage by making hidden strip charts do much less work. If STUI is bogging down your machine close the strip charts that you don't need.
</ul>

<h3>1.1.1 2011-09-23</h3>

<p>Visible changes:
<ul>
    <li>APOGEE QL exposure table title includes the exposure type.
</ul>

<p>Bug fixes:
<ul>
    <li>Ticket <a href="https://trac.sdss3.org/ticket/1442">1442</a> exception in _utrDataCallback.
</ul>

<h3>1.1 2011-09-09</h3>

<p>Visible changes:
<ul>
    <li>APOGEE: added support for APOGEE and APOGEE QuickLook

    <li>SOP window:
    <ul>
        <li>Added commands for APOGEE.
        <li>Bypassed systems are now shown in red (at Craig's suggestion) and you can now cancel bypass commands to re-enable the buttons.
        <li>Added alt field for Goto Gang Change.
        <li>SOP commands for BOSS are now shown with "(BOSS)". The parenthesis indicate that you leave out the "BOSS" when typing the commands on the command line.
        <li>Buttons that showed "Go To..." now show "Goto..." to simplify the mapping between the SOP window and sop commands: type what you see except lowercase the first letter and omit spaces and text in parenthesis.
        <li>Help strings for parameters now show the name you send to sop, not the displayed name, to simplify the mapping between the SOP window and sop commands. (This was already true of command buttons).
    </ul>

    <li>Guider Window:
    <ul>
        <li>Added support for refraction balance ratio guide parameter.
        <li>Ticket <a href="https://trac.sdss3.org/ticket/620">620</a>: add guider CCD temperature to Guider window.
        <li>You may apply guide parameter changes even if the guider is off.
        <li>Guider and exposure state are now displayed in color to indicate severity. The only "normal" guide state is "on" because we always run the guider while taking science data.
        <li>The exposure time widget always tracks the current value from the guider, it no longer tracks data from the currently displayed image. I hope this will be less confusing for users.
        <li>Updated to handle new "failed" guider and exposure states (thanks, Craig!).
    </ul>
    
    <li>Some windows now save state when you select Save Window Positions.
    <ul>
        <li>Log windows save filter information.
        <li>APOGEE saves which detail panels are open.
    </ul>

    <li>Log window:
    <ul>
        <li>Added filters "Commands", "Commands and Replies", "My Commands and Replies".
        <li>Show a CmdStarted and CmdDone message for each command (using data from the cmds actor).
    </ul>

    <li>MCP window: added status of APOGEE and MARVELS gang connector sensors.
</ul>

<p>Bug fixes:
<ul>
    <li>SOP did not shrink when stages were removed from commands.
    <li>TUI.Base.Wdg.FocusWdg had some minor bugs that were exposed by the new APOGEE Collimate controls.
</ul>

<p>Internal changes:
<ul>
    <li>LogEntry objects now have a cmdID field for enhanced filtering.
    <li>Added code to the Alerts window to work around hub bug <a href="https://trac.sdss3.org/ticket/1181">1611</a>1611 (keys that have a list of 0 values are reported by the keys actor to have a single value of "None"). This avoids error messages when there are no active alerts or disabled alert rules.
</ul>

<h3>1.0+1 2011-04-04</h3>

<p>Visible changes:
<ul>
    <li>Added a preliminary APOGEE window. It only shows some QuickLook data and has no controls.
</ul>

<p>Internal changes:
<ul>
    <li>Stop sending "plot display=..." as part of the guide on command. It is not longer needed and it caused an error message if the DISPLAY environment variable was not set.
</ul>

<h3>1.0 2011-03-15</h3>

<p>First release.

</body>
</html>
