<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<title>TUI:Guiding</title>
</head>
<body>

<h2><a href="../index.html">TUI</a>:Guiding</h2>

<p>Guiding is controlled by windows in the Guide menu:</p>

<ul>
	<li>NA2 Guider (the filterwheel and focus are not yet supported from TUI, but you can use text commands).
	<li><a href="EchelleSlitviewerWin.html">Echelle Slitviewer</a> (windowing is not yet supported, but you can use text commands).
	<li>DIS Slitviewer.
</ul>

<p>All of these guide windows work pretty much the same way, though slit viewers have some extra buttons and there are a few device-specific controls for each camera. Each guide window downloads and displays images and allows you to auto guide or manually guide.

<p>Please take some time to familiarize yourself with the guide windows. They have more hidden functionality than other TUI windows.

<h2>Setup</h2>

<p>Before attempting to guide, please do the following:
<ul>
	<li>Make sure a <a href="../TUIMenu/PreferencesWin.html#Exposures:SaveTo">Save To</a> directory is set in Preferences (in the Exposures panel). This is necessary for guide images to be downloaded and displayed.
	
	<li>Buy a 3-button mouse (if you don't already have one). They are cheap and useful. The guide window makes heavy use of the middle and right buttons.
</ul>

<h2>Download</h2>

<p>New guide images are automtically downloaded whenever the appropriate guide window is open. If the Current/Hold button says Current then these newly downloaded files are automatically displayed.

<p>Only the most recent 100 images are saved, and those are deleted when you quit TUI. However, guide images may be left on your disk if TUI is killed or quits unexpectedly. <b>Please check your <a href="../TUIMenu/PreferencesWin.html#Exposures:SaveTo">Save To</a> directory once in awhile to make sure guide images are not accumulating.</b>

<h2>The Guide Window</h2>

<p>This section describes the elements of the guide window.

<h3><a name="HistoryControls"></a>Row 1: History Controls</h3>

<p>Allows you to select an image from the image history or from disk.
<ul>
	<li><b>Left and Right Arrows</b> allow you to see previous images.
	<ul>
		<li>Note: if the next or previous image is out of sequence then the appropriate arrow will be hollow. This will happen if you use the Choose... button to view an image that is not in the history. It will also happen if the history is trimmed while you are viewing an image very near the beginning of the history. 
	</ul>
	<li><b>Current/Hold</b> toggle button allows you to hold the current image or automatically display new images as they come in.
	<ul>
		<li><b>Warning:</b> most guide controls are disabled unless you are in Current mode!
		<li>Hold is set automatically if you use the history arrows or Choose... button. This is so a new guide image won't overwrite your display.
		<li>When you are done looking at old images, toggle it back to Current. This will update your display to the current image and keep it updated, and will re-enable the guide controls.
	</ul>
	<li><b>Name</b> field shows the name of the displayed image. You may copy this text but not change it.
	<li><b>Choose...</b> button allows you to view any FITS file.
	<ul>
		<li>If you select one that is already in the history, you jump there. Otherwise you create a new history entry and the image will be shown as out of sequence (as indicated by hollow left and right arrows).
	</ul>
</ul>

<h3><a name="Image"></a><a name="ImageControls"></a>Row 2: Image Controls</h3>

<p>Controls image appearance: intensity scaling, zoom, etc.
<ul>
	<li><b>Scaling Function menu</b> sets the image scaling function. Your choices range from Linear to very nonlinear.
	
	<li><a name="DataRange"></a><b>Data Range menu</b> adjusts the range of intensities displayed. 99% means that the central 99% of scaled intensity values are shown in the available shades of gray. All dimmer value are black and all brighter values are white. You can fine-tune the data range by varying the <a href="#ContrastMode">black and white levels</a>.

	<li><a name="SelectMode"></a><img src="crosshair.gif" /> <b>Select Mode</b>:
	<ul>
		<li>Click near the center of a centroid circle to select an existing star. Click away from the center of any circle to select nothing.
		
		<li>Click and drag about a star to centroid a star. The pixels in the box will be used to compute the centroid and that centroid is selected. In detail: the biggest circle that fits in your box is used, and that circle is shifted as needed so as to be centered on the star.
		
		<li>Note: if you don't like the radius used for an existing centroid, feel free to centroid the star again.
		
		<li>Control-Click to move the telescope such that point you click on is centered on the boresight and take a new image. This only works for a slit viewer and only if the image is current (i.e. if the telescope has not been moved since this image was taken).


		<li>Typically you leave the "plus" icon selected and temporarily choose the next two modes by clicking the middle or right mouse button. But you may permanently change modes by clicking an icon.
	</ul>

	<li><a name="Contrast"></a><img src="contrast.gif" /> <b>Contrast Mode</b> (middle mouse button): adjust the black and white levels. The left/right position of the mouse controls the black level and the up/down position controls the white level. Double-click to restore the default levels. This is a fine adjustment beyond that provided by the <a href="#DataRange">data range menu</a>. The middle mouse button will temporarily select this mode.

	<li><a name="ZoomMode"><img src="magnifier.gif" /></a> <b>Zoom Mode</b> (right mouse button): adjust the zoom. Click and drag from the upper left to the lower right to zoom in on the region you select. Drag in the opposite direction to zoom out (zoom out further for a smaller box). Double-click to see the entire image. The right mouse button will temporarily select this mode.

	<li><b>Zoom factor</b> shows the current zoom factor. You may manually set a zoom factor by typing the value and &lt;return&gt;.	

	<li><b>Sat button</b> controls whether saturated pixels are highlighted (in red).
	<li><b>Mask button</b> controls whether masked (bad) pixels are highlighted (in pale green).
</ul>

<h3><a name="ImagePane"></a>Row 3: Image Pane</h3>

<p>The middle area shows the guide image. Typically you will also see circles around stars that have been centroided. Further annotations are planned (for boresight and slit) but are not yet implemented.

<p>All centroids are shown as circles; the radius of the circle is the radius of the data used to perform the centroid. Green circles shown results from "findstars" (which have radii that are automatically determined) and yellow circles show other centroids.

<p>The currently selected star (if any) is shown as an "X". Its color matches the color of the centroid circle.

<h3><a name="DataPane"></a>Row 4: Data Pane</h3>

<p>Data about the image at the current cursor and the selected star (if any).

<h3><a name="AcquisitionControls"></a>Row 5: Acquisition Controls</h3>

<p>Exposure time, bin factor, etc. are all controlled here. If you change a value then the control's background goes pink to indicate the value has been modified. The modified value will be applied if you command an exposure.

<ul>
	<li><b>Exp Time</b> exposure time, in seconds.
	<li><b>Bin</b> bin factor
	<li><b>Thresh</b> star finding threshold. A pixel is considered to contain signal if its value is at least thresh &sigma; above the median. If you change thresh and type &lt;return&gt; a new find stars is performed
</ul>

<h3>Row 6: Device-Specific Controls</h3>

<p>This row (if present) contains controls specific to the current guide camera. See the TUI documentation specific to that guide camera for more information.

<h3><a name="GuidingStatus"></a>Row 7: Guiding Status</h3>

<p>The row just above the status bar shows the current state of guiding.

<h3><a name="StatusBar"></a>Row 8: Status Bar</h3>

<p>The status bar shows help for whatever control is under the mouse and also shows the state of the current or most recent command.

<h3><a name="GuidingControls"></a>Last Row: Guiding Controls</h3>

<p>The guiding controls are very different for a slit viewer vs a sky-facing guider.

<h4>Slit Viewer Controls</h4>

<p>Slit viewers have one hidden control: control-click on a pixel to center that pixel on the boresight and take a new slitviewer image. This is a handy way to set up automatic guiding or perform manual guiding. Note that control-click only works in <a href="#SelectMode">select mode</a> and on the current slitviewer image.

<p>The visible controls are as follows (with the less-used controls in the top row):

<ul>
	<li><b>Man Guide</b> start manual guiding. To adjust the position either control-click on the center of your object or use the Nudger window.
	<li><b>Guide on Field Star</b> guide on a selected field star. This keeps whatever pixel is on the boresight centered there, so please be sure your science object is well centered on the boresight before you click this button.
	<p>	
	<li><b>Expose</b> take a new exposure.
	<li><b>Guide on Slit</b> guide on your science object. <b>Before you push this button:</b>
	<ul>
		<li>Center your object reasonably well, e.g. by using control-click.
		<li>Make sure you like the centroid on your object. Adjust exposure time and other settings as needed. If you can't get a good centroid with your object down the slit, please don't try to guide on it.
	</ul>
	<li><b>Stop Guiding</b> stop guiding.
	<li><b>Cancel</b> cancel the current command and enable the button(s) again. Please give the command a chance to execute before cancelling it.
	<li><b>DS9</b> display the current image in the ds9 image viewer (if available).
</ul>

<p>

<h4>Guider Controls</h4>
<ul>
	<li><b>Guide</b> start guiding on the selected star. This button will be grayed out if there is no selected star and it will fail if the image is not current (i.e. if the telescope has been moved since the image was taken).
	<li><b>Stop Guiding</b> stop guiding.
	<li><b>Cancel</b> cancel the current command and enable the button(s) again. Please give the command a chance to execute before cancelling it.
	<li><b>DS9</b> display the current image in the ds9 image viewer (if available).
</ul>

</body>
</html>
